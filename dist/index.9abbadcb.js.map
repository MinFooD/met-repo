{"mappings":"","sources":["js/export.js"],"sourcesContent":["async function exportExcel() {\r\n  try {\r\n    // Gửi yêu cầu để lấy file từ API\r\n    const response = await fetch(`https://${window.config.apiBaseUrl}/api/Export`, {\r\n      method: 'GET',\r\n      headers: {\r\n        Authorization: `Bearer ${jwtToken}`, // Đặt token vào header\r\n      },\r\n    })\r\n    if (!response.ok) {\r\n      alert('response is not ok!')\r\n      document.getElementById('errorMessage').textContent = 'Bạn không có quyền dùng chức năng này'\r\n      throw new Error('Không thể thực hiện yêu cầu xuất dữ liệu.')\r\n    }\r\n    // Nhận file dưới dạng blob\r\n    const blob = await response.blob()\r\n    // Tạo URL từ blob và xử lý tải file\r\n    const url = window.URL.createObjectURL(blob)\r\n    const a = document.createElement('a')\r\n    a.href = url\r\n    a.download = 'ExcelDemo.xlsx' // Tên file tải về\r\n    document.body.appendChild(a)\r\n    a.click()\r\n    a.remove()\r\n    window.URL.revokeObjectURL(url) // Giải phóng URL\r\n    // Sau khi tải file xong, chuyển hướng về trang khác\r\n    window.location.href = '/html/index.html'\r\n  } catch (error) {\r\n    console.error('Có lỗi xảy ra:', error.message)\r\n  }\r\n}\r\n"],"names":[],"version":3,"file":"index.9abbadcb.js.map"}