var e=globalThis,t={},o={},n=e.parcelRequire94c2;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var a={id:e,exports:{}};return t[e]=a,n.call(a.exports,a,a.exports),a.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},e.parcelRequire94c2=n);var a=n.register;a("kxgSl",function(e,t){Object.defineProperty(e.exports,"logout",{get:()=>c,set:void 0,enumerable:!0,configurable:!0});var o=n("LMLC2");async function a(){let e=document.getElementById("username").value,t=document.getElementById("password").value;console.log(window.config.apiBaseUrl),await r({username:e,password:t})}async function r(e){try{let t=await fetch(`https://${window.config.apiBaseUrl}/api/Auth/Login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),o=await t.json();o.userName&&localStorage.setItem("loginName",o.userName),o.jwtToken?(localStorage.setItem("jwtToken",o.jwtToken),window.location.href="/"):(console.log("No Token! Please check."),document.getElementById("errorMessage").textContent="Token Failed")}catch(e){console.error("Error:",e),document.getElementById("errorMessage").textContent="Login failed!"}}async function l(){let e=document.getElementById("username").value,t=document.getElementById("password").value,o=document.getElementById("CheckboxLarge").checked?["writer"]:["reader"];if(console.log("Username:",e),console.log("Password:",t),console.log("Roles:",o),!e||!t){alert("Username and password cannot be empty.");return}i({userName:e,password:t,roles:o},e)}async function i(e,t){try{let n=await fetch(`https://${window.config.apiBaseUrl}/api/Auth/Register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(n.ok){let e=await n.text();console.log("Registration Successful:",e),alert(e);try{await (0,o.initializeOneSignal)(t)}catch(e){console.warn("Failed to initialize OneSignal:",e)}window.location.href="/login"}else{let e=await n.text();alert("Registration failed. Please check your permissions."),console.error("Failed to register:",n.status,e)}}catch(e){alert("Load data failed, please check your connection to the backend."),console.error("Error:",e)}}async function c(){localStorage.removeItem("jwtToken"),window.location.href="/login",localStorage.setItem("logoutMessage","Logout succeeded!")}document.addEventListener("DOMContentLoaded",()=>{let e=localStorage.getItem("logoutMessage");e&&(alert(e),localStorage.removeItem("logoutMessage"));let t=document.getElementById("CheckboxLarge"),o=document.getElementById("checkboxLabel");function n(){let e=t.checked?"Writer":"Reader";o.textContent!==e&&(o.textContent=e)}null!=t&&(t.addEventListener("change",n),n()),window.OneSignal||console.error("OneSignal chưa được tải. Vui lòng kiểm tra.")});let s={Register:i,login:r,callLogin:a,callRegister:l,initializeOneSignal:o.initializeOneSignal};Object.keys(s).forEach(e=>{window[e]=s[e]})}),a("LMLC2",function(e,t){}),n("kxgSl");
//# sourceMappingURL=login.d85ab1aa.js.map
