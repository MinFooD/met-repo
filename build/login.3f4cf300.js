function e(e,t,o,n){Object.defineProperty(e,t,{get:o,set:n,enumerable:!0,configurable:!0})}var t=globalThis,o={},n={},a=t.parcelRequire94c2;null==a&&((a=function(e){if(e in o)return o[e].exports;if(e in n){var t=n[e];delete n[e];var a={id:e,exports:{}};return o[e]=a,t.call(a.exports,a,a.exports),a.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){n[e]=t},t.parcelRequire94c2=a);var r=a.register;r("kxgSl",function(t,o){e(t.exports,"logout",()=>c);var n=a("LMLC2");async function r(){let e=document.getElementById("username").value,t=document.getElementById("password").value;console.log(window.config.apiBaseUrl),await i({username:e,password:t})}async function i(e){try{let t=await fetch(`https://${window.config.apiBaseUrl}/api/Auth/Login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),o=await t.json();o.userName&&localStorage.setItem("loginName",o.userName),o.jwtToken?(localStorage.setItem("jwtToken",o.jwtToken),window.location.href="/"):(console.log("No Token! Please check."),document.getElementById("errorMessage").textContent="Token Failed")}catch(e){console.error("Error:",e),document.getElementById("errorMessage").textContent="Login failed!"}}async function l(){let e=document.getElementById("username").value,t=document.getElementById("password").value,o=document.getElementById("CheckboxLarge").checked?["writer"]:["reader"];if(console.log("Username:",e),console.log("Password:",t),console.log("Roles:",o),!e||!t){alert("Username and password cannot be empty.");return}s({userName:e,password:t,roles:o},e)}async function s(e,t){try{let o=await fetch(`https://${window.config.apiBaseUrl}/api/Auth/Register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(o.ok){let e=await o.text();console.log("Registration Successful:",e),alert(e),await (0,n.initializeOneSignal)(t),window.location.href="/login"}else{let e=await o.text();alert("Registration failed. Please check your permissions."),console.error("Failed to register:",o.status,e)}}catch(e){alert("Load data failed, please check your connection to the backend."),console.error("Error:",e)}}async function c(){localStorage.removeItem("jwtToken"),window.location.href="/login",localStorage.setItem("logoutMessage","Logout succeeded!")}document.addEventListener("DOMContentLoaded",()=>{let e=localStorage.getItem("logoutMessage");e&&(alert(e),localStorage.removeItem("logoutMessage"));let t=document.getElementById("CheckboxLarge"),o=document.getElementById("checkboxLabel");function n(){let e=t.checked?"Writer":"Reader";o.textContent!==e&&(o.textContent=e)}null!=t&&(t.addEventListener("change",n),n())});let d={Register:s,login:i,callLogin:r,callRegister:l,initializeOneSignal:n.initializeOneSignal};Object.keys(d).forEach(e=>{window[e]=d[e]})}),r("LMLC2",function(t,o){e(t.exports,"initializeOneSignal",()=>n);async function n(e){try{await OneSignal.init({appId:"523487ee-5286-415a-8973-77cbd85d83bb",serviceWorkerPath:"/OneSignalSDKWorker.js",promptOptions:{slidedown:{enabled:!0}}}),await OneSignal.setExternalUserId(e),console.log("external_id đã được gán:",e),await OneSignal.showSlidedownPrompt(),console.log("Yêu cầu thông báo đã hiển thị.")}catch(e){console.error("Lỗi khi khởi tạo hoặc hiển thị thông báo:",e)}}}),a("kxgSl");
//# sourceMappingURL=login.3f4cf300.js.map
