var e=globalThis,t={},o={},n=e.parcelRequire94c2;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var r={id:e,exports:{}};return t[e]=r,n.call(r.exports,r,r.exports),r.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},e.parcelRequire94c2=n),(0,n.register)("kxgSl",function(e,t){async function o(){let e=document.getElementById("username").value,t=document.getElementById("password").value;console.log(window.config.apiBaseUrl),await n({username:e,password:t})}async function n(e){try{let t=await fetch(`https://${window.config.apiBaseUrl}/api/Auth/Login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),o=await t.json();o.userName&&localStorage.setItem("loginName",o.userName),o.jwtToken?(localStorage.setItem("jwtToken",o.jwtToken),window.location.href="/",o.userId&&localStorage.setItem("userId",o.userId)):(console.log("No Token! Please check."),document.getElementById("errorMessage").textContent="Token Failed")}catch(e){console.error("Error:",e),document.getElementById("errorMessage").textContent="Login failed!"}}async function r(){let e=document.getElementById("username").value,t=document.getElementById("password").value,o=document.getElementById("CheckboxLarge").checked?["writer"]:["reader"];if(!e||!t){alert("Username and password cannot be empty.");return}try{await a({userName:e,password:t,roles:o})}catch(e){console.error("Error getting playerId from OneSignal:",e)}}async function a(e){try{let t=await fetch(`https://${window.config.apiBaseUrl}/api/Auth/Register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let e=await t.text();console.log("Registration Successful:",e),alert(e),window.location.href="/login"}else{let e=await t.text();alert("Registration failed. Please check your permissions."),console.error("Failed to register:",e)}}catch(e){alert("Load data failed, please check your connection to the backend."),console.error("Error:",e)}}async function l(){localStorage.clear(),OneSignal.logout(),window.location.href="/login",localStorage.setItem("logoutMessage","Logout succeeded!")}Object.defineProperty(e.exports,"logout",{get:()=>l,set:void 0,enumerable:!0,configurable:!0}),document.addEventListener("DOMContentLoaded",()=>{let e=localStorage.getItem("logoutMessage");e&&(alert(e),localStorage.removeItem("logoutMessage"));let t=document.getElementById("CheckboxLarge"),o=document.getElementById("checkboxLabel");function n(){let e=t.checked?"Writer":"Reader";o.textContent!==e&&(o.textContent=e)}null!=t&&(t.addEventListener("change",n),n()),window.OneSignal?console.error("OneSignal đã được tải. Vui lòng kiểm tra."):console.error("OneSignal chưa được tải. Vui lòng kiểm tra.")});let i={Register:a,login:n,callLogin:o,callRegister:r,initializeOneSignal:initializeOneSignal};Object.keys(i).forEach(e=>{window[e]=i[e]})}),n("kxgSl");
//# sourceMappingURL=login.23de1dcf.js.map
